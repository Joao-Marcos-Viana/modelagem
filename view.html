<!doctype html>
<html lang="pt-BR">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Leitura+ - Demonstra√ß√£o</title>
    <style>
        :root {
            --bg: #120617;
            --panel: #241730;
            --card: #2b1f3a;
            --accent: #8a5cf6;
            --accent-2: #cfa3ff;
            --text: #f8f5ff;
            --muted: #cfc6e9;
            --glass: rgba(255, 255, 255, 0.03);
        }

        * {
            box-sizing: border-box;
        }

        body {
            margin: 0;
            font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
            background: linear-gradient(180deg, var(--bg), #0f0814);
            color: var(--text);
            -webkit-font-smoothing: antialiased;
        }

        header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 18px 24px;
            background: linear-gradient(90deg, var(--accent), var(--accent-2));
            box-shadow: 0 8px 30px rgba(0, 0, 0, 0.4);
        }

        .brand {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .logo {
            width: 48px;
            height: 48px;
            border-radius: 10px;
            background: linear-gradient(135deg, var(--accent), var(--accent-2));
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 22px;
            box-shadow: 0 8px 28px rgba(138, 92, 246, 0.2);
        }

        header h1 {
            margin: 0;
            font-size: 1.1rem;
        }

        header .controls {
            display: flex;
            gap: 10px;
            align-items: center;
        }

        header input {
            padding: 8px 12px;
            border-radius: 999px;
            border: 0;
            background: var(--glass);
            color: var(--text);
            width: 220px;
        }

        main {
            display: flex;
            gap: 18px;
            padding: 20px;
        }

        aside {
            width: 300px;
        }

        .card {
            background: linear-gradient(180deg, rgba(255, 255, 255, 0.02), rgba(0, 0, 0, 0.05));
            border-radius: 12px;
            padding: 12px;
        }

        .sidebar-list {
            display: flex;
            flex-direction: column;
            gap: 8px;
            margin-top: 10px;
        }

        .saga-item {
            padding: 8px;
            border-radius: 8px;
            background: transparent;
            color: var(--muted);
            cursor: default;
            border: 1px solid rgba(255, 255, 255, 0.02);
        }

        .content {
            flex: 1;
            display: flex;
            flex-direction: column;
            gap: 14px;
        }

        .book-top {
            display: flex;
            gap: 16px;
            align-items: flex-start;
        }

        .cover {
            width: 160px;
            height: 220px;
            border-radius: 10px;
            background: linear-gradient(180deg, var(--accent-2), var(--accent));
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            color: #2b0233;
        }

        .book-info h2 {
            margin: 0;
            color: var(--accent-2);
        }

        .muted {
            color: var(--muted);
            font-size: 0.92rem;
        }

        .stars span {
            cursor: pointer;
            font-size: 22px;
            margin-right: 4px;
        }

        .actions {
            display: flex;
            gap: 8px;
            margin-top: 10px;
        }

        .btn {
            background: var(--accent);
            color: #fff;
            padding: 8px 12px;
            border-radius: 10px;
            border: 0;
            cursor: pointer;
            box-shadow: 0 8px 24px rgba(138, 92, 246, 0.12);
        }

        .btn.ghost {
            background: transparent;
            border: 1px solid rgba(255, 255, 255, 0.04);
        }

        .tabs {
            display: flex;
            gap: 8px;
            margin-top: 12px;
        }

        .tab {
            padding: 8px 10px;
            border-radius: 10px;
            background: transparent;
            border: 0;
            color: var(--muted);
            cursor: pointer;
        }

        .tab.active {
            background: rgba(255, 255, 255, 0.03);
            color: var(--text);
        }

        .panes {
            margin-top: 10px;
        }

        textarea, input {
            width: 100%;
            padding: 8px;
            border-radius: 8px;
            border: 1px solid rgba(255, 255, 255, 0.03);
            background: transparent;
            color: var(--text);
            margin-top: 8px;
        }

        .comment {
            padding: 8px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.01);
            margin-bottom: 8px;
        }

        .playlist-item, .reco-item {
            padding: 8px;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.01);
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-box {
            height: 180px;
            overflow: auto;
            border-radius: 8px;
            padding: 8px;
            background: rgba(0, 0, 0, 0.08);
            margin-bottom: 8px;
        }

        footer {
            padding: 14px;
            text-align: center;
            color: var(--muted);
        }

        .small {
            font-size: 0.85rem;
        }

        /* responsive */
        @media (max-width: 900px) {
            main {
                flex-direction: column;
                padding: 12px;
            }
            aside {
                width: 100%;
            }
            .cover {
                width: 120px;
                height: 170px;
            }
        }
        .footer-text {
            padding: 8px 10px;
            border-radius: 10px;
            background: transparent;
            border: 0;
            cursor: pointer;
            color: #b5b5b5;
        }
        .footer-text a {
            color: #b5b5b5;
            text-decoration: none;
        }
    </style>
</head>
<body>
    <header>
        <div class="brand">
            <div class="logo">üìö</div>
            <h1>Leitura+ <span class="small muted">demo</span></h1>
        </div>
        <div class="controls">
            <input id="searchBox" placeholder="Pesquisar livro, autor ou tag..." />
            <button class="btn" id="themeBtn">Tema</button>
        </div>
    </header>

    <main>
        <aside>
            <div class="card">
                <h3>Explorar</h3>
                <div class="muted small">Sagas em destaque</div>
                <div class="sidebar-list" id="sidebarSagas"></div>
                <hr style="border:none;height:1px;background:rgba(255,255,255,0.02);margin:10px 0">
                <div class="muted small">Recomenda√ß√µes</div>
                <div id="sidebarRecos" style="margin-top:8px"></div>
            </div>
        </aside>

        <section class="content">
            <div class="card">
                <div class="book-top">
                    <div class="cover" id="bookCover">Capa</div>
                    <div class="book-info">
                        <h2 id="bookTitle">O Exemplo da Leitura</h2>
                        <div class="muted" id="bookAuthor">Autor Exemplar</div>
                        <div style="margin-top:8px" id="avgRating">Sem avalia√ß√µes</div>
                        <div class="actions">
                            <div class="stars" id="ratingStars">Avaliar:
                                <span data-star="1">‚òÜ</span><span data-star="2">‚òÜ</span><span data-star="3">‚òÜ</span><span data-star="4">‚òÜ</span><span data-star="5">‚òÜ</span>
                            </div>
                            <button class="btn" id="followSaga">Seguir Saga</button>
                            <button class="btn ghost" id="openPlaylist">Abrir Playlist</button>
                        </div>
                    </div>
                </div>

                <p id="bookDesc" style="margin-top:12px" class="muted small">
                    Este √© um texto de exemplo sobre o livro. D√™ duplo clique em qualquer palavra complicada para pedir uma explica√ß√£o (mock).
                </p>

                <div class="tabs" id="tabs">
                    <button class="tab active" data-tab="comments">Coment√°rios</button>
                    <button class="tab" data-tab="playlist">Playlist</button>
                    <button class="tab" data-tab="sagas">Saga</button>
                    <button class="tab" data-tab="glossary">Gloss√°rio</button>
                    <button class="footer-text"><a href="chat.html">Chat</a></button>
                </div>

                <div class="panes">
                    <div data-pane="comments" class="pane">
                        <div id="commentsList"><div class="muted">Nenhum coment√°rio ainda ‚Äî seja o primeiro!</div></div>
                        <textarea id="commentText" placeholder="Escreva um coment√°rio..."></textarea>
                        <button class="btn" id="sendComment">Enviar coment√°rio</button>
                    </div>

                    <div data-pane="playlist" class="pane" style="display:none">
                        <div id="playlistList"><div class="muted">Nenhuma m√∫sica cadastrada.</div></div>
                        <input id="songTitle" placeholder="T√≠tulo da m√∫sica" />
                        <input id="songUrl" placeholder="URL (ex: https://)" />
                        <button class="btn" id="addSong">Adicionar √† playlist</button>
                    </div>

                    <div data-pane="sagas" class="pane" style="display:none">
                        <div id="sagaList"><div class="muted">Este livro pertence √† saga: <b>Saga Exemplar</b> (Ordem: 1/3)</div></div>
                    </div>

                    <div data-pane="glossary" class="pane" style="display:none">
                        <div class="muted small">Duplo clique em uma palavra da descri√ß√£o para ver explica√ß√£o.</div>
                        <div id="glossaryResult" class="card" style="margin-top:8px">Nenhuma sele√ß√£o</div>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3>Recomenda√ß√µes</h3>
                <div id="recommendations" style="margin-top:8px"></div>
            </div>
        </section>
    </main>

    <footer>
        Tema roxo/lil√°s ‚Ä¢ Interface demo inspirada em Skoob + Spotify ‚Ä¢ Tudo local (HTML puro)
    </footer>

    <script>
        /* ---------- Dados de demo (local) ---------- */
        const demoBook = {
            id: 1,
            title: "O Exemplo da Leitura",
            author: "Autor Exemplar",
            description: "Energia sonora e texturas liter√°rias ‚Äî experimente associar m√∫sicas √† leitura para aumentar imers√£o.",
            cover: null,
            saga: { name: "Saga Exemplar", order: 1, total: 3 }
        };

        const demoRecos = [
            { id: 2, title: "Outra Hist√≥ria", author: "Autora X" },
            { id: 3, title: "Contos e Can√ß√µes", author: "Autor Y" }
        ];

        /* ---------- Utilidades ---------- */
        function $(id) { return document.getElementById(id); }
        function save(key, value) { localStorage.setItem(key, JSON.stringify(value)); }
        function load(key, fallback) { const v = localStorage.getItem(key); return v ? JSON.parse(v) : fallback; }

        /* ---------- Inicializa√ß√£o ---------- */
        document.getElementById('bookTitle').innerText = demoBook.title;
        document.getElementById('bookAuthor').innerText = demoBook.author;
        document.getElementById('bookDesc').innerText = demoBook.description;
        document.getElementById('sagaList').innerHTML = `<div class="muted small">Saga: <b>${demoBook.saga.name}</b> ‚Äî Ordem: ${demoBook.saga.order}/${demoBook.saga.total}</div>`;
        document.getElementById('sidebarSagas').innerHTML = `<div class="saga-item">${demoBook.saga.name} ‚Äî ${demoBook.saga.total} livros</div>`;
        const recEl = $('recommendations'); recEl.innerHTML = demoRecos.map(r => `<div class="reco-item"><div><b>${r.title}</b><div class="muted small">${r.author}</div></div><button class="btn ghost" onclick="openBook(${r.id})">Abrir</button></div>`).join('');

        /* ---------- Tabs ---------- */
        document.querySelectorAll('.tab').forEach(t => {
            t.addEventListener('click', () => {
                document.querySelectorAll('.tab').forEach(x => x.classList.remove('active'));
                t.classList.add('active');
                const tab = t.dataset.tab;
                document.querySelectorAll('[data-pane]').forEach(p => p.style.display = (p.dataset.pane === tab ? '' : 'none'));
            });
        });

        /* ---------- Comments (localStorage) ---------- */
        const COMMENTS_KEY = 'demo_comments_book_' + demoBook.id;
        function renderComments() {
            const arr = load(COMMENTS_KEY, []);
            const el = $('commentsList');
            if (!arr.length) { el.innerHTML = '<div class="muted">Nenhum coment√°rio ainda ‚Äî seja o primeiro!</div>'; return; }
            el.innerHTML = arr.map(c => `<div class="comment"><b>${escapeHtml(c.user)}</b> <div class="muted small">${c.date}</div><div style="margin-top:6px">${escapeHtml(c.text)}</div></div>`).join('');
        }
        $('sendComment').addEventListener('click', () => {
            const text = $('commentText').value.trim();
            if (!text) return alert('Escreva um coment√°rio.');
            const user = 'Usu√°rio local';
            const arr = load(COMMENTS_KEY, []);
            arr.unshift({ user, text, date: new Date().toLocaleString() });
            save(COMMENTS_KEY, arr);
            $('commentText').value = '';
            renderComments();
        });
        renderComments();

        /* ---------- Playlist ---------- */
        const PLAY_KEY = 'demo_playlist_book_' + demoBook.id;
        function renderPlaylist() {
            const arr = load(PLAY_KEY, []);
            const el = $('playlistList');
            if (!arr.length) { el.innerHTML = '<div class="muted">Nenhuma m√∫sica cadastrada.</div>'; return; }
            el.innerHTML = arr.map((s, i) => `<div class="playlist-item"><div>${escapeHtml(s.title)} <div class="muted small">${escapeHtml(s.url)}</div></div><button class="btn ghost" onclick="removeSong(${i})">Remover</button></div>`).join('');
        }
        $('addSong').addEventListener('click', () => {
            const title = $('songTitle').value.trim(); const url = $('songUrl').value.trim();
            if (!title || !url) return alert('Preencha t√≠tulo e URL.');
            const arr = load(PLAY_KEY, []);
            arr.unshift({ title, url });
            save(PLAY_KEY, arr);
            $('songTitle').value = ''; $('songUrl').value = '';
            renderPlaylist();
        });
        function removeSong(i) { const arr = load(PLAY_KEY, []); arr.splice(i, 1); save(PLAY_KEY, arr); renderPlaylist(); }
        renderPlaylist();

        /* ---------- Chat (local) ---------- */
        const CHAT_KEY = 'demo_chat_book_' + demoBook.id;
        function renderChat() {
            const arr = load(CHAT_KEY, []);
            const box = $('chatBox');
            if (!arr.length) { box.innerHTML = '<div class="muted">Chat vazio ‚Äî comece a conversar!</div>'; return; }
            box.innerHTML = arr.map(m => `<div class="small"><b>${escapeHtml(m.user)}</b> <span class="muted">(${m.date})</span><div>${escapeHtml(m.text)}</div></div>`).join('');
            box.scrollTop = box.scrollHeight;
        }
        $('sendChat').addEventListener('click', () => {
            const text = $('chatText').value.trim(); if (!text) return;
            const user = $('chatUser').value.trim() || 'An√¥nimo';
            const arr = load(CHAT_KEY, []);
            arr.push({ user, text, date: new Date().toLocaleTimeString() });
            save(CHAT_KEY, arr);
            $('chatText').value = ''; $('chatUser').value = '';
            renderChat();
        });
        renderChat();

        /* ---------- Ratings (local) ---------- */
        const RATING_KEY = 'demo_rating_book_' + demoBook.id;
        function renderRating() {
            const r = load(RATING_KEY, null);
            const stars = document.querySelectorAll('#ratingStars span');
            stars.forEach(s => s.textContent = '‚òÜ');
            if (r) { for (let i = 0; i < r; i++) stars[i].textContent = '‚òÖ'; $('avgRating').innerText = `Sua avalia√ß√£o: ${r} ‚òÖ`; }
            else $('avgRating').innerText = 'Sem avalia√ß√µes pessoais';
        }
        document.querySelectorAll('#ratingStars span').forEach(s => {
            s.addEventListener('click', () => {
                const v = parseInt(s.dataset.star, 10);
                save(RATING_KEY, v);
                renderRating();
            });
        });
        renderRating();

        /* ---------- Glossary (double click) ---------- */
        document.getElementById('bookDesc').addEventListener('dblclick', async () => {
            const sel = window.getSelection().toString().trim();
            if (!sel) return;
            // mock explanation
            const simple = `Explica√ß√£o simples para "${sel}": conceito resumido e em linguagem acess√≠vel.`;
            const compare = `Compara√ß√£o para "${sel}": imagine que ${sel} √© como um exemplo cotidiano...`;
            $('glossaryResult').innerHTML = `<b>${escapeHtml(sel)}</b><div style="margin-top:8px">${escapeHtml(simple)}<br><i class="muted small">${escapeHtml(compare)}</i></div>`;
        });

        /* ---------- Search (client-side) ---------- */
        const allBooks = [demoBook, ...demoRecos];
        $('searchBox').addEventListener('input', (e) => {
            const q = e.target.value.toLowerCase();
            if (!q) { // show default recos
                document.getElementById('sidebarRecos').innerHTML = '';
                return;
            }
            const matches = allBooks.filter(b => (b.title + ' ' + (b.author || '')).toLowerCase().includes(q));
            document.getElementById('sidebarRecos').innerHTML = matches.map(m => `<div class="reco-item"><div><b>${m.title}</b><div class="muted small">${m.author || ''}</div></div><button class="btn ghost" onclick="openBook(${m.id})">Abrir</button></div>`).join('');
        });

        /* ---------- Helpers ---------- */
        function escapeHtml(s) { return String(s || '').replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;'); }
        function openBook(id) { alert('Abrir livro id=' + id + ' (demo)'); }

        /* ---------- Small extras ---------- */
        document.getElementById('followSaga').addEventListener('click', () => alert('Voc√™ come√ßou a seguir a saga: ' + demoBook.saga.name));
        document.getElementById('openPlaylist').addEventListener('click', () => {
            // switch to playlist tab
            document.querySelector('.tab[data-tab="playlist"]').click();
        });
        renderComments();
        renderPlaylist();
        renderChat();
        renderRating();
    </script>
</body>
</html>